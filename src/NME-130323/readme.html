<!-- Generated by Nyctergatis Markup Engine, Mar 23 2013 11:18:16 -->
<html>
<body>
<h1>Nyctergatis Markup Engine</h1>
<p>Nyctergatis Markup Engine (NME) is a library for parsing text with
markup and converting it to other text formats. The markup has the
following goals:</p>

<ul>
  <li>A set of simple rules a user can learn and rely on.</li>
  <li>Robust specifications with room for evolution without
  breaking compatibility.</li>
</ul>
<p>The markup is based on <a href="http://www.wikicreole.org">Creole</a>. Creole is a
collaborative work in progress; only its core features are frozen.
This is why the documentation of the markup used by NME is not Creole
itself, but the documentation provided with the engine.</p>
<p>NME provides the core cross-platform conversion code and optional
extensions which can be embedded in other applications;
platform-specific support functions for C++, Windows MFC, OS X
(Objective-C), and GTK+ (Linux); and command-line tools for
single-file conversion as well as the creation of EPUB files from a
set of files.</p>
<h2>Overview</h2>
<p>The library core is made of two source files in C:</p>

<dl>
  <dt><tt>NME.h</tt></dt>
  <dd>header file with all extern declarations and detailed usage
  information, compatible with C++;</dd>
  <dt><tt>NME.c</tt></dt>
  <dd>function and data definitions.</dd>
</dl>
<p>In addition, the following optional code is provided:</p>

<dl>
  <dt><tt>NMEStyle.h</tt> and <tt>NMEStyle.c</tt></dt>
  <dd>functions to collect style information separately</dd>
  <dt><tt>NMEAutolink.h</tt> and <tt>NMEAutolink.c</tt></dt>
  <dd>automatic conversion of CamelCase words and URLs to links;</dd>
  <dt><tt>NMEPluginCalendar.h</tt> and <tt>NMEPluginCalendar.c</tt></dt>
  <dd>plugin to create the calendar corresponding to a given month
  and year in a table.</dd>
  <dt><tt>NMEPluginRaw.h</tt> and <tt>NMEPluginRaw.c</tt></dt>
  <dd>plugin to embed raw data copied verbatim to the output
  stream;</dd>
  <dt><tt>NMEPluginReverse.h</tt> and <tt>NMEPluginReverse.c</tt></dt>
  <dd>plugin to reverse text;</dd>
  <dt><tt>NMEPluginRot13.h</tt> and <tt>NMEPluginRot13.c</tt></dt>
  <dd>plugin to apply ROT-13 conversion to text (letters A-M and
  N-Z are switched);</dd>
  <dt><tt>NMEPluginTOC.h</tt> and <tt>NMEPluginTOC.c</tt></dt>
  <dd>plugin to create a table of contents;</dd>
  <dt><tt>NMEPluginUppercase.h</tt> and
  <tt>NMEPluginUppercase.c</tt></dt>
  <dd>plugin to convert text to uppercase;</dd>
  <dt><tt>NMEPluginWiki.h</tt> and <tt>NMEPluginWiki.c</tt></dt>
  <dd>plugin to extract metadata and title;</dd>
  <dt><tt>NMETest.h</tt> and <tt>NMETest.c</tt></dt>
  <dd>implementation test (check the correct use of output markup
  and hooks);</dd>
  <dt><tt>NMECpp.h</tt>, <tt>NMEErrorCpp.h</tt> and
  <tt>NMEStyleCpp.h</tt></dt>
  <dd>C++ glue;</dd>
  <dt><tt>NMEGtk.h</tt> and <tt>NMEGtk.c</tt></dt>
  <dd>display of text with NME markup as styled text in GTK+ (Linux
  and Unix);</dd>
  <dt><tt>NMEMFC.h</tt> and <tt>NMEMFC.cpp</tt></dt>
  <dd>display of text with NME markup as styled text in MFC
  (Windows);</dd>
  <dt><tt>NMEObjC.h</tt> and <tt>NMEObjC.m</tt></dt>
  <dd>display of text with NME markup as styled text in Cocoa (OS
  X).</dd>
</dl>
<p>These files implement applications:</p>

<dl>
  <dt><tt>NMEMain.c</tt></dt>
  <dd>command-line application which filters its input (stdin),
  which is text with markup, and writes to its output (stdout) the
  result of the conversion to HTML or several other formats. To build
  it, cd to the NME distribution directory and type <tt>make</tt>;</dd>
  <dt><tt>NMERandomGen.c</tt></dt>
  <dd>command-line tool which generates random input to test NME.
  To build it, cd to the NME distribution directory and type <tt>make
  nmerandom</tt>;</dd>
  <dt><tt>NMETest.cpp</tt></dt>
  <dd>simple C++ test application. To build it, cd to the NME
  distribution directory and type <tt>make nmecpp</tt>;</dd>
  <dt><tt>NMEGtkTest.c</tt></dt>
  <dd>test application for <tt>NMEGtk</tt> which displays styled
  text in a GTK window. It requires GTK+ 2.0, available at <a
  href="http://www.gtk.org">http://www.gtk.org</a>. To build it, cd
  to the NME distribution directory and type <tt>make nmegtk</tt>.</dd>
</dl>
<p>NME can also be used to create EPUB files. EPUB is a popular
format for e-books (see below). Here are the files related to EPUB:</p>

<dl>
  <dt><tt>NE.h</tt> and <tt>NE.c</tt></dt>
  <dd>EPUB file building, with contents provided as XHTML
  (independent of NME, relies on the library <a href="http://zlib.net">zlib</a> for
  zip creation);</dd>
  <dt><tt>NMEEPub.h</tt> and <tt>NMEEPub.c</tt></dt>
  <dd>NME style to convert from NME markup to EPUB XHTML;</dd>
  <dt><tt>NMEEPubMain.c</tt></dt>
  <dd>command-line application which creates EPUB files from a set
  of text files with NME markup.</dd>
</dl>
<h2>EPUB</h2>
<p>EPUB is a &quot;distribution and interchange format standard for
digital publications and documents&quot;. It is a standard designed
by the <a href="http://www.openebook.org"> International Digital Publishing Forum</a> (IDPF)
and used by many e-book readers, such as iBook on Apple iPad and
other IOS devices, and software applications on most platforms.</p>
<p>EPUB are zip files with a .epub extension. They contain a set of
content files in xhtml and other formats (jpeg, svg, etc. for
images), and additional files for the document structure and
information about the title, author, and other metadata.</p>
<h3>Command-line tool</h3>
<p>The command-line tool <tt>nmeepub</tt>, whose source code is
provided with NME, converts a set of NME files to a single EPUB
document. Typically, the book is written as a single NME file or as
one NME file per chapter. Chapters start with a title (line starting
with <tt>=</tt>), sections (if any) with a subtitle (line starting
with <tt>==</tt>), etc. A table of contents is created automatically.</p>
<p>Images can be embedded with <tt>{{...}}</tt>. In addition, the
following extensions are implemented:</p>
<pre>
Text&lt;&lt; endnote Text of the endnote &gt;&gt;
</pre>
<p>Notes are collected and linked forward and backward to the text
they are related to. The endnote text itself can contain NME markup.</p>
<pre>
&lt;&lt; title Document title &gt;&gt;
&lt;&lt; author Author name &gt;&gt;
&lt;&lt; identifier Document identifier &gt;&gt;
&lt;&lt; language Language ISO code &gt;&gt;
&lt;&lt; subject Document subject &gt;&gt;
&lt;&lt; description Document description &gt;&gt;
&lt;&lt; publisher Publisher name &gt;&gt;
&lt;&lt; date Publishing date (ISO format) &gt;&gt;
&lt;&lt; source Original source of the document &gt;&gt;
&lt;&lt; rights Copyright notice &gt;&gt;
</pre>
<p>Metadata information can be placed anywhere in the NME files.</p>
<pre>
&lt;&lt; cover Cover image file &gt;&gt;
</pre>
<p>The cover image file (e.g. <tt>cover.png</tt>) is an image to be
used for the book cover. Currently, images are the only reliable way
to have the desired cover on all platforms, and must be created
outside <tt>nmeepub</tt>.</p>
<h3>Usage</h3>
<p>With <tt>nmeepub</tt>, it is extremely simple to convert a text
document to a high-quality, easy-to-read e-book which can be
distributed or just copied to your reader for personal use. Starting
from the text of a book, for instance, you can open it in a text
editor and quickly find titles to mark them with an equal sign, and
throw some metadata tags (at least the title and author to identify
quickly the document in your virtual library). Then once the
conversion is done, the resulting EPUB file can be transferred to
your reading device (for the iPad, drag the file to iTunes and
synchronize your tablet).</p>
<p>The next step is to add a cover. Use any image editing
application, create an image (typical dimension: height of 780
pixels, width of 580 pixels), save it as a PNG file (e.g.
<tt>cover.png</tt> in the same folder as your NME files), and add
<tt>&lt;&lt; cover cover.png &gt;&gt;</tt> in your NME file.</p>
<p>A typical NME file could look like this:</p>
<pre>
&lt;&lt; title My Book &gt;&gt;
&lt;&lt; author My Name &gt;&gt;
&lt;&lt; cover cover.png &gt;&gt;

= Chapter 1
...

= Chapter 2
...
</pre>
<h2>License</h2>
<p>Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.</p>
<p>Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution.</p>
<p>Neither the name of Yves Piguet nor the names of its contributors
may be used to endorse or promote products derived from this software
without specific prior written permission.</p>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<hr />
<h2>Release notes</h2>
<h3>23 March 2013</h3>

<ul>
  <li>Parenthesis in boolean expressions to suppress gcc warnings</li>
  <li>Documentation of NME usage updated</li>
  <li>Global XML entity dictionary <tt>NMEXMLCharDict</tt></li>
  <li>Links used verbatim as link text when no explicit link text
  is provided</li>
  <li>Buffer overflow in <tt>addLinkBegin</tt> fixed</li>
  <li><tt>%L</tt> in <tt>beginDD</tt> fixed</li>
</ul>
<h3>23 October 2011</h3>

<ul>
  <li>Superfluous scoping operator for copy operator removed</li>
  <li><tt>NMETest.cpp</tt> renamed to avoid object file name
  collision</li>
  <li><tt>NMETest.c</tt> and <tt>NMETest.h</tt> added to distrib in
  Makefile</li>
</ul>
<h3>4 October 2011</h3>

<ul>
  <li>EPUB support</li>
  <li>support for RichEdit version &gt;= 0x0200 on MFC</li>
  <li>tracking of NME source line number</li>
  <li>conditional expressions in output format strings with
  <tt>?:</tt></li>
  <li><tt>}}}</tt> handled as normal characters outside pre block</li>
  <li>bug fixes related to nesting of output markup and hook calls</li>
  <li>tests with new <tt>nmerandom</tt> tool</li>
  <li>Visual C++ 2010 projects and code adjustments</li>
  <li>improved Doxygen documentation</li>
  <li>with LaTeX output, numbered and definition lists are
  translated to enumerate and definition environments respectively
  instead of itemize</li>
  <li>gcc warning <i>hex escape sequence out of range</i> fixed in
  <tt>NMEPluginWiki.h</tt></li>
  <li>new functions <tt>NMEResetOutput</tt> and
  <tt>NMECurrentInputIndex</tt></li>
  <li>list following paragraphs without empty line resulted in
  invalid HTML; fixed</li>
</ul>
<h3>31 March 2010</h3>

<ul>
  <li>arrays in lists didn't balance closing tags correctly; fixed
  (arrays force list end)</li>
  <li>sublists weren't converted to compliant HTML (they were
  outside <tt>&lt;li&gt;&lt;/li&gt;</tt> markup); fixed</li>
  <li>the distribution archive lacked <tt>NMEStyle.c</tt>,
  <tt>NMEStyle.h</tt> and <tt>NMEErrorCpp.h</tt>; fixed</li>
  <li><tt>make distrib</tt> didn't work with what it produced;
  fixed</li>
  <li>wrong description of function <tt>NMEPluginTOC</tt>; fixed</li>
  <li><tt>--null-plugins</tt> option in <tt>NMEMain.c</tt></li>
  <li><tt>NMEPluginWiki.h</tt>, <tt>NMEPluginWiki.c</tt> and option
  <tt>--metadata</tt> in <tt>NMEMain.c</tt> (metadata and title
  extraction)</li>
  <li>use <tt>id</tt> attributes for anchors instead of
  <tt>name</tt> in a separate <tt>a</tt> element</li>
  <li>if <tt>useHTMLEmphasisTags</tt> is defined, use
  <tt>&lt;em&gt;&lt;/em&gt;</tt> and
  <tt>&lt;strong&gt;&lt;/strong&gt;</tt> instead of
  <tt>&lt;i&gt;&lt;/i&gt;</tt> and <tt>&lt;b&gt;&lt;/b&gt;</tt>
  respectively</li>
  <li><tt>}{</tt> was wrongly recognized as an image opening tag;
  fixed</li>
  <li><tt>NMECurrentListNesting</tt> uses <tt>|</tt> for tables</li>
  <li>context is available in <tt>wordwrapPermFun</tt> callback and
  used for NME output to prevent line breaks in tables</li>
  <li>indentation wasn't always set correctly, resulting in too
  many leading spaces at the beginning of lines; fixed</li>
  <li>new <tt>NMEOutputFormatDebug</tt> format for debugging, and
  <tt>--debug</tt> and <tt>--debug2</tt> options in
  <tt>NMEMain.c</tt></li>
  <li>new <tt>--structspan</tt> option in <tt>NMEMain.c</tt></li>
  <li>Objective-C wrapper (files <tt>NMEObjC.h</tt> and
  <tt>NMEObjC.m</tt>)</li>
</ul>
<h3>19 November 2008</h3>

<ul>
  <li>new hook function <tt>charHookFun</tt> called when a character
  is copied to output; useful to match text fragments in input and
  output</li>
  <li>new hook function <tt>getVarFun</tt> for custom variables in
  expressions</li>
  <li>character <tt>=</tt> was skipped in headings even when it
  wasn't the optional trailing heading markup; fixed</li>
</ul>
<h3>25 August 2008</h3>

<ul>
  <li>new variable <tt>p</tt> in output format strings for output
  offset</li>
  <li>new format <tt>NMEOutputFormatTextCompact</tt> with less
  blank lines than <tt>NMEOutputFormatText</tt></li>
  <li>reduced right margin for RTF output</li>
  <li>tables should be followed by an empty line; fixed</li>
  <li><tt>--easylink</tt> option in <tt>NMEMain.c</tt></li>
</ul>
<h3>15 October 2007</h3>

<ul>
  <li>unnested unnumbered or numbered list items weren't recognized
  when following sublists; fixed</li>
</ul>
<h3>12 October 2007</h3>

<ul>
  <li>NME output better escapes characters when it has to, but
  usually doesn't unless required</li>
  <li>in NME output, support for mixed nested lists</li>
  <li>double-slash is considered as a part of URL instead of italic
  markup only if it follows a digit, letter, '+', '-' or '.', and a
  colon; and it precedes a nonblank character; therefore, a tilde
  before the colon, such as <tt>abc~://...</tt>, restores the meaning
  of the double-slash sequence as italic markup</li>
</ul>
<h3>9 October 2007</h3>

<ul>
  <li>in lists, item markup must match, else it is interpreted as
  plain characters or as bold or monospace markup</li>
  <li><tt>NMEMFC.cpp</tt> compiles correctly without
  <tt>_UNICODE</tt></li>
</ul>
<h3>4 October 2007</h3>

<ul>
  <li>link encoding for RTF output</li>
  <li><tt>NMEGtk</tt> tuning</li>
  <li>parHook and divHook bugs, revealed by new option
  <tt>--checkhooks</tt> of <tt>NMEMain.c</tt>, fixed</li>
</ul>
<h3>29 September 2007</h3>

<ul>
  <li>new high-level function <tt>NMEGtkInsert</tt> to insert NME
  text directly into a <tt>GtkTextBuffer</tt>; <tt>NMEGtkTest.c</tt>
  modified to use it</li>
  <li><tt>NMEProcess</tt> optionally returns the output length in
  unicode characters, assuming UTF-8 input</li>
  <li>in <tt>NMEMain.c</tt>, option <tt>--strictcreole</tt> doesn't
  disable escape character anymore</li>
  <li><tt>NMECpp.h</tt> uses C++ exceptions for error handling only
  if <tt>UseNMECppException</tt> is defined; else method
  <tt>getOutput</tt> returns an error code (the choice is useful for
  platforms where exceptions are not supported or have a large cost)</li>
  <li>minor bug fixes in <tt>NMEStyle.c</tt> (plain paragraphs and
  tables)</li>
  <li>refined <tt>NMEMFC.cpp</tt></li>
  <li>error codes in hook callbacks weren't handled correctly;
  fixed</li>
  <li>support for links and images in span hook and
  <tt>NMEStyle</tt></li>
  <li>support for links in <tt>NMEGtk</tt> and <tt>NMEMFC</tt></li>
  <li>in <tt>NMECpp</tt> and <tt>NMEStyleCpp</tt>, copy
  constructors and assignment operators</li>
  <li>NMEEncodeURLFun has an additional argument for
  application-specific data, and structure NMEOutputFormat has an
  additional field for it</li>
</ul>
<h3>23 August 2007</h3>

<ul>
  <li>bug in unicode offset computation fixed</li>
  <li><tt>kNMEProcessOptXRef</tt> wasn't handled correctly; fixed</li>
  <li>blanks following starting = or preceding ending = in titles
  are ignored</li>
  <li>in <tt>NMEGtkApplyStyle</tt>, additional argument for the
  offset of NME output in GTK+ text buffer</li>
  <li>in LaTeX output, braces are now escaped and bold italic is
  suported</li>
  <li>monospace text wasn't signalled to <tt>spanHookFun</tt>;
  fixed</li>
  <li>MFC glue with <tt>NMEMFC.cpp</tt> and <tt>NMEMFC.h</tt>
  (function <tt>NMEMFCSetRichText</tt> which renders NME text into a
  <tt>CRichEditCtrl</tt>)</li>
</ul>
<h3>5 July 2007</h3>

<ul>
  <li>option to have verbatim rendered as monospace
  (<tt>kNMEProcessOptVerbatimMono</tt>)</li>
</ul>
<h3>4 July 2007</h3>

<ul>
  <li>callback to check valid wordwrap points</li>
  <li>bad unicode encoding for RTF fixed</li>
  <li>tilde is an escape character before any nonblank character,
  including alphanumeric</li>
</ul>
<h3>19 June 2007</h3>

<ul>
  <li>support for UCS-16 offset (16-bit unicode offsets when the
  input is encoded in UTF-8)</li>
  <li>C++ glue for <tt>NMEStyle</tt> (<tt>NMEStyleCpp.h</tt>)</li>
  <li>in block preformatted, when 3 closing braces follow spaces at
  the beginning of a line, one space is removed</li>
</ul>
<h3>7 June 2007</h3>

<ul>
  <li><tt>NMEStyle</tt> to separate text from style</li>
  <li><tt>NMEGtkTest.c</tt>, a test application for
  <tt>NMEStyle</tt> which displays a text file with NME markup in a
  GTK+ 2 window</li>
  <li>support for placeholders (plugin option to use triple angle
  brackets instead of double angle brackets)</li>
  <li>bug fixes</li>
</ul>
<h3>30 May 2007</h3>

<ul>
  <li>heading of level 1 and 2 following other paragraphs without a
  blank line were always numbered; fixed</li>
  <li>XHTML-compatible image tag in HTML output</li>
  <li>plugins source code in separate files</li>
  <li>in plugin tables, single field for option flags instead of
  separate boolean fields</li>
  <li>in plugin tables, option flag for plugins between paragraphs</li>
  <li>characters weren't encoded in preformatted blocks; now there
  is a separate callback</li>
  <li>new opaque structure NMEContext for output data and other
  contextual information, to reduce the number of arguments passed
  around and to support string output with embedded expressions from
  plugin and autoconvert functions</li>
  <li>variable <tt>o</tt> (offset in source code) in embedded
  expressions, useful as unique identifiers for hyperlinks</li>
  <li>hook functions for paragraphs and sections</li>
  <li>functions to retrieve current output format and options in
  plugin, autoconvert and hook functions, and to copy input text from
  input to output</li>
  <li>change in the arguments of NMEProcess, to keep original
  source code</li>
  <li>table of contents plugin (sample code for the new features)</li>
  <li>C++ glue (<tt>NMECpp.h</tt>)</li>
</ul>
<h3>24 April 2007</h3>

<ul>
  <li>optional automatic links for URLs beginning with
  <i>http://</i>, <i>https://</i>, <i>ftp://</i>, <i>mailto:</i></li>
  <li>optional separate source file for automatic links for
  camelcase and URL</li>
  <li>options to disable indented paragraphs and definitions lists</li>
  <li>in NMEMain.c, option <tt>--strictnme</tt> to disable features
  not in Creole 1.0</li>
</ul>
<h3>19 April 2007</h3>

<ul>
  <li>optional numbering of headings, level 1 and/or 2</li>
  <li>images weren't supported in links; fixed</li>
  <li>empty cells weren't output correctly in text format; fixed</li>
  <li>in NMEMain.c, most plugins have <tt>reparseOutput</tt> set,
  so that word-wrap is applied to output</li>
  <li>Python glue for the command-line application
  (<tt>nme.py</tt>)</li>
</ul>
<h3>18 April 2007</h3>

<ul>
  <li>plugins now use the &quot;placeholder&quot; syntax, with double
  angle brackets</li>
  <li>references to plugin globally-unique identifiers removed</li>
  <li>option to match only the beginning of plugin names</li>
</ul>
<h3>16 April 2007</h3>

<ul>
  <li>doc header and trailer suppressed in plugin output</li>
  <li>less references to Creole in source code</li>
  <li>&quot;null&quot; format for producing no output</li>
  <li>better handling of plugins, especially those which produce
  NME code which must be processed again</li>
  <li>autoconversion plugins which make substitutions before NME
  conversion (as an example, NMEMain.c has an option to convert
  camelCase words to links)</li>
</ul>
<h3>30 March 2007</h3>

<ul>
  <li>wrong encoding of unicode characters &gt;= 32768 for RTF
  output; fixed</li>
  <li>optional processing of plugin output</li>
  <li>calendar plugin in NMEMain.c</li>
</ul>
<h3>23 March 2007</h3>

<ul>
  <li>support for parenthesis in expressions in output strings</li>
  <li>replicated strings themselves can contain expressions, and
  syntax for expressions in output strings has been changed to
  support it</li>
  <li>default font size in structure <tt>NMEOutputFormat</tt> and
  support for default font size (with nonpositive values, HTML does
  not contain font size specifications at all, relying on the browser
  defaults)</li>
  <li>argument <tt>withPreAndPostDoc</tt> of <tt>NMEProcess</tt>
  replaced by <tt>options</tt></li>
  <li>images</li>
  <li>option to consider line breaks as paragraph separators</li>
  <li>minor documentation fixes</li>
</ul>
<h3>20 March 2007</h3>

<ul>
  <li>Initial release</li>
</ul>
<hr />
<p>Copyright Yves Piguet, 4 October 2011. May be distributed with NME
or cited with proper attribution.</p>
</body>
</html>
